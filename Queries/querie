#Produtos mais vendidos
SELECT pr.produto, Sum(qty) as unidadesvendidas
FROM vendas ve
JOIN produtos pr
ON pr.codigo = ve.codigo
GROUP BY pr.produto
ORDER BY unidadesvendidas DESC

# Receita total por produtos
SELECT pr.produto, Sum(qty*preco) as receitatotal
FROM vendas ve
JOIN produtos pr
ON pr.codigo = ve.codigo
GROUP BY pr.produto
ORDER BY receitatotal DESC

#Receita total por pa√≠s
SELECT ve.ship_country, Sum(qty*preco) as receita_por_pais
FROM produtos pr
JOIN vendas ve 
ON pr.codigo = ve.codigo
GROUP BY ve.ship_country
ORDER BY receita_por_pais DESC

#Produto mais vendido por pais 
SELECT *
FROM (
    SELECT 
        ve.ship_country,
        pr.produto,
        SUM(ve.qty) AS total_unidades,
        ROW_NUMBER() OVER (
            PARTITION BY ve.ship_country
            ORDER BY SUM(ve.qty) DESC
        ) AS rn
    FROM vendas ve
    JOIN produtos pr
        ON pr.codigo = ve.codigo
    GROUP BY ve.ship_country, pr.produto
) AS ranking
WHERE rn = 1;



